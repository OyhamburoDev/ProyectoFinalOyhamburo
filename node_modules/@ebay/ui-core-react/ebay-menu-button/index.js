"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("react"),r=require("classnames"),y=require("../common/component-utils/utils/index.js"),h=require("../menu-CV-INYLM.js"),Q=require("../button-DGuEBUDJ.js"),X=require("../icon-button-Cwaj-eT9.js"),Y=require("../icon-TuxfQndO.js"),Z=require("../common/random-id/index.js"),ee=require("../common/event-utils/index.js"),ne=({type:t,variant:a="button",className:c,text:m="",fixWidth:d,reverse:i,expanded:x,noToggleIcon:b,checked:u,collapseOnSelect:w,a11yText:N,prefixId:I,prefixLabel:S,onClick:L=()=>{},onExpand:R=()=>{},onCollapse:K=()=>{},onChange:P=()=>{},onSelect:T=()=>{},children:f,...A})=>{const[s,E]=e.useState(x),[_,F]=e.useState(),B=e.useRef(null),k=e.useRef(),M=y.filterByType(f,[h.EbayMenuItem,v]),O=M.map(n=>!!n.props.checked),[p,U]=e.useState(O),W=y.findComponent(f,q),j=y.findComponent(f,Y.EbayIcon),D=te({text:m,prefixId:I,prefixLabel:S,menuButtonLabel:W,icon:j}),V=r("menu-button",c),$=r("menu-button__menu",{"menu-button__menu--fix-width":d,"menu-button__menu--reverse":i});e.useEffect(()=>{const n=o=>{const l=k.current,g=l&&l.contains(o.target);(w||!g)&&E(!1)};return s?(R(),setTimeout(()=>{document.addEventListener("click",n,!1)})):s===!1&&K(),()=>document.removeEventListener("click",n,!1)},[s]),e.useEffect(()=>{F(Z.randomId())},[]);const z=n=>{ee.handleEscapeKeydown(n,()=>{var o;E(!1),(o=B.current)==null||o.focus()})},C={ref:B,className:"menu-button__button","aria-expanded":!!s,"aria-haspopup":!0,"aria-label":N,"aria-controls":_,"aria-labelledby":I,onClick:n=>{E(!s),L(n)},...A},G=(n,o)=>{if(t==="radio"||t==="checkbox"){const l=p.map((g,J)=>o.indexes.includes(J));U(l)}P(n,o)},H=()=>{const n=p.findIndex(Boolean);return n>-1?n:u};return e.createElement("span",{className:V},a==="overflow"?e.createElement(X.EbayIconButton,{icon:"overflowVertical16",...C}):e.createElement(Q.EbayButton,{variant:a==="form"?"form":void 0,bodyState:b?void 0:"expand",...C},D),s&&e.createElement(h.EbayMenu,{baseEl:"div",ref:k,type:t,className:$,tabIndex:-1,id:_,autofocus:!0,checked:H(),onKeyDown:z,onChange:G,onSelect:T},M.map((n,o)=>e.cloneElement(n,{...n.props,className:r(n.props.className,"menu-button__item"),key:o,checked:p[o]}))))};function te({text:t,prefixId:a,prefixLabel:c,menuButtonLabel:m,icon:d}){const i=t.length?e.createElement("span",null,t):null,b=[!a&&c&&[e.createElement("span",{className:"menu-button-prefix-label"},c),e.createElement(e.Fragment,null,"Â ")],m||i],u=[d,b].flat().filter(Boolean);return u.length?u:null}const v=({className:t,...a})=>e.createElement("hr",{...a,className:r(t,"menu-button__separator"),role:"separator"}),q=({children:t})=>e.createElement(e.Fragment,null,t);exports.EbayMenuButtonItem=h.EbayMenuItem;exports.EbayMenuButton=ne;exports.EbayMenuButtonLabel=q;exports.EbayMenuButtonSeparator=v;
