"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("react"),J=require("../menu-button-BZ66jxvI.js"),H=require("classnames"),ee=require("../debounce-BQsYxxOL.js"),te=require("../common/component-utils/utils/index.js"),U=require("../icon-TuxfQndO.js"),ne=require("../common/component-utils/forwardRef/index.js");require("../array.polyfill.flat-5BAolFdk.js");const re=1,T=9,K=4,$=2,oe=T-$;function ie(e,n,a=e,s=null){const h=s==="show-last"||s==="overflow"&&e>T,l=s==="overflow"&&e>T,c=Math.min(a,e),v=Math.max(0,n-Math.ceil((c-1)/2)),E=c<K?n:Math.max(0,n-Math.floor((c-1)/2)),m=(h?E:v)+c,d=m>=e,D=n<=K,I=(b,i)=>{const r=k(e,b,i);return c>2?(r[i-2]="dots",r[i-1]="hidden",r[e-1]="visible"):c>1&&(r[i-1]="dots"),r},g=(b,i)=>{if(D)return I(0,i);if(d){const _=k(e,e-oe,e);return _[0]="visible",_[1]="dots",_}const r=k(e,n-$,n+$+1);return r[0]="visible",r[1]=D?"visible":"dots",r[e-2]="dots",r[e-1]="visible",r};return d&&e<=T?k(e,e-c):h?l?g(E,m):I(E,m):k(e,v,m)}function ae(e,n,a,s="show-range"){if(e===-1)return[];const h=s==="overflow"?T:se(Math.min(a,n),re,T);return ie(a,e-1,h,s)}function se(e,n,a){return e<=n?n:e>=a?a:e}function k(e,n,a){return Array(e).fill("hidden").fill("visible",n,a)}function ce(e){if(!e)return 0;e.style.width="100vw";const n=e.offsetWidth;return e.style.width=null,n}const ue=({id:e="ebay-pagination",className:n,a11yCurrentText:a="Pagination - Current Page",a11yPreviousText:s="Previous page",a11yNextText:h="Next page",variant:l="show-range",fluid:c=!1,onPrevious:v=()=>{},onNext:E=()=>{},onSelect:m=()=>{},children:d,...D})=>{const I=t.useRef(null),g=t.useRef([]);g.current=t.Children.map(d,t.createRef);const b=te.filterBy(d,({props:o})=>o.type===void 0||o.type==="page").length,i=t.useRef(0),r=t.useRef(0),_=()=>{var y,N,x,p;const o=r.current||((N=(y=g.current[0])==null?void 0:y.current)==null?void 0:N.offsetWidth);r.current=o;const f=i.current||((p=(x=g.current[1])==null?void 0:x.current)==null?void 0:p.offsetWidth);return i.current=f,f?Math.floor((ce(I.current)-o*2)/f):0},[A,L]=t.useState([]),[w,q]=t.useState(0),S=o=>{const f=o||g.current.findIndex(x=>{var p;return((p=x.current)==null?void 0:p.getAttribute("aria-current"))==="page"}),y=_(),N=ae(f,y,b,l);q(f),L(["hidden",...N])};t.useEffect(()=>{const o=ee.debounce(S,16);return S(),window.addEventListener("resize",()=>o()),()=>{window.removeEventListener("resize",()=>o())}},[d]);const W=o=>{let f=0;const y=[],N=[],x=[],p=A.indexOf("dots"),F=A.lastIndexOf("dots");return t.Children.map(d,(j,M)=>{const{type:O="page",current:Q,disabled:Y,href:G,children:V}=j.props,B=A[M]==="dots",P=`${e}-item-${M}`,X=A[M]==="hidden",Z={current:Q,disabled:Y,href:G,type:B&&O==="page"?"separator":O,children:B?t.createElement(U.EbayIcon,{name:"overflowHorizontal24",focusable:!1}):V,pageIndex:O==="page"?f++:void 0,key:P,hide:X,onPrevious:v,onNext:E,onSelect:m,a11yPreviousText:s,a11yNextText:h,ref:g.current[M]};if((X||B)&&O==="page"){const C=t.createElement(J.EbayFakeMenuButtonItem,{key:P,href:G,onClick:z=>{G||z.preventDefault();const R=z.currentTarget;m(z,{value:(R==null?void 0:R.innerText)||"",index:f}),S(Number(R==null?void 0:R.innerText))}},V);p===F&&x.push(C),w-2>p&&M<w&&y.push(C),w+2<F&&M>w&&N.push(C)}if(o==="page"&&B&&l==="overflow"){let C=x;return p!==F&&(C=M===2?y:N),t.createElement("li",{key:P},t.createElement("span",{className:"pagination__item",role:"separator"},t.createElement(J.EbayMenuButton,{a11yText:"Menu",borderless:!0,variant:"overflow",noToggleIcon:!0},C)))}return o===O?t.cloneElement(j,Z):null})},u=`${e}-pagination-heading`;return t.createElement("nav",{...D,role:"navigation",className:H(n,"pagination",{"pagination--fluid":c}),"aria-labelledby":u,ref:I},t.createElement("span",{"aria-live":"polite",role:"status"},t.createElement("h2",{className:"clipped",id:u},a)),W("previous"),t.createElement("ol",{className:"pagination__items"},W("page")),W("next"))},le=({pageIndex:e=0,key:n,current:a,disabled:s,type:h="page",href:l,hide:c,children:v,a11yPreviousText:E="Previous page",a11yNextText:m="Next page",onSelect:d,onNext:D,onPrevious:I,className:g,style:b,forwardedRef:i,...r})=>{const _=u=>{var o;d(u,{value:((o=u.currentTarget)==null?void 0:o.innerText)||"",index:e})},A=u=>{u.currentTarget.getAttribute("aria-disabled")||D(u)},L=u=>{u.currentTarget.getAttribute("aria-disabled")||I(u)},w=!!l,q=w?"a":"button",S=w?"icon-link":"icon-btn",W={...b,minWidth:"40px"};switch(h){case"previous":return t.createElement(q,{...r,ref:i,"aria-disabled":s?"true":void 0,"aria-label":E,href:s?void 0:l,className:H(S,"pagination__previous"),style:W,onClick:L},t.createElement(U.EbayIcon,{name:"arrowLeft16"}));case"next":return t.createElement(q,{...r,ref:i,"aria-disabled":s?"true":void 0,"aria-label":m,href:s?void 0:l,className:H(S,"pagination__next"),style:W,onClick:A},t.createElement(U.EbayIcon,{name:"arrowRight16"}));case"separator":return t.createElement("span",{key:n,style:b,className:"pagination__item",ref:i,role:"separator"},v);default:return t.createElement("li",{...r,hidden:c},t.createElement(q,{ref:i,"aria-current":a?"page":void 0,href:l,className:"pagination__item",style:b,key:n,onClick:_},v))}},me=ne.withForwardRef(le);exports.EbayPagination=ue;exports.EbayPaginationItem=me;
