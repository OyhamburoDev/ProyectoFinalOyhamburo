"use strict";const t=require("react"),V=require("classnames"),U=require("./use-roving-index-DoAVBgsp.js"),S=require("./common/event-utils/index.js"),T=require("./common/component-utils/forwardRef/index.js");require("./array.polyfill.flat-5BAolFdk.js");const $=require("./badge-CoHKfiPt.js"),j=require("./icon-TuxfQndO.js"),A=({className:d,checked:r,type:I,focused:a=!1,tabIndex:p,disabled:y,badgeNumber:f,badgeAriaLabel:h,children:v,...w})=>{const u=t.useRef(null),i=f!==void 0;t.useEffect(()=>{u.current&&a&&u.current.focus()},[u,a]);const x=["radio","checkbox"];return t.createElement("div",{"aria-label":h,...w,ref:u,className:V(d,"menu__item",i&&"menu__item--badged"),role:z(I),"aria-checked":x.includes(I)?r:void 0,"aria-disabled":y,tabIndex:a?0:p},t.createElement("span",{"aria-hidden":i},v,i&&t.createElement($.EbayBadge,{type:"menu",number:f})),t.createElement(j.EbayIcon,{name:"tick16"}))};function z(d){return{radio:"menuitemradio",checkbox:"menuitemcheckbox"}[d]||"menuitem"}const G=({baseEl:d="span",type:r,priority:I="secondary",checked:a,className:p,autofocus:y,onClick:f=()=>{},onKeyDown:h=()=>{},onChange:v=()=>{},onSelect:w=()=>{},forwardedRef:u,children:i,...x})=>{const m=t.Children.toArray(i),[C,q]=U.useRovingIndex(i,A,y===!0?0:void 0),[l,F]=t.useState(m.map(()=>!1)),B=n=>m.reduce((e,c,s)=>n[s]?[...e,c.props.value]:e,[]),g=n=>n.reduce((e,c,s)=>c?[...e,s]:e,[]),_=(n,e)=>({index:n,checked:g(e)}),R=(n,e)=>({..._(n,e),indexes:g(e),checkedValues:B(e)}),M=(n,e,c=!1)=>{let s=!1;const b=l.map((E,o)=>{const P=c?!1:E;return n===o?(E!==e&&(s=!0),e):P});if(s)return F(b),b},k=n=>{switch(r){case"radio":return M(n,!0,!0);case"checkbox":return M(n,!l[n],!1);default:return l.map((e,c)=>c===n)}};t.useEffect(()=>{if(r==="radio")if(a===void 0){const n=m.findIndex(e=>e.props.checked);n>-1&&k(n)}else k(a);else r==="checkbox"&&F(m.map(n=>!!n.props.checked))},[]);const K=(n,e,c)=>{switch(r){case"radio":case"checkbox":return v(n,R(e,c));default:return w(n,_(e,c))}},D=(n,e)=>{let c;switch(S.isActionKey(n.key)&&(c=k(e),c&&K(n,e,c)),r){case"radio":case"checkbox":return h(n,R(e,c||l));default:return h(n,_(e,c||l))}},N=(n,e)=>{q(e);const c=k(e);c&&K(n,e,c)};return t.createElement(d,{...x,className:V(p,"menu")},t.createElement("div",{className:"menu__items",role:"menu",ref:u},m.map((n,e)=>{const{onClick:c=()=>{},onFocus:s=()=>{},onKeyDown:b=()=>{},...E}=n.props;return t.cloneElement(n,{...E,type:r,focused:e===C,tabIndex:C===void 0?0:-1,checked:l[e],onFocus:o=>{q(e),s(o)},onClick:o=>{N(o,e),c(o),f(o)},onKeyDown:o=>{D(o,e),b(o)}})})))},H=T.withForwardRef(G);exports.EbayMenu=H;exports.EbayMenuItem=A;
